# 📦 Packet Reflector 示例

本例是一个基础的 P4 网络编程示例，旨在展示如何使用 P4 语言实现最简单的报文处理逻辑。通过构建最小化的网络拓扑（单主机与单交换机），该示例演示了交换机接收到数据包后，将其回送至入端口的“数据包反射”功能。

该示例适合作为初学者理解 P4 报文处理模型（Parse → Match-Action → Deparse）的起点。

## 🧱 示例结构

- `main.py`：Python 脚本，用于定义网络拓扑结构与 P4 程序入口。
- `test.py`：测试脚本，用于向交换机发送数据包并检测反射效果。
- `main.p4`：P4 实现文件，完成了以太网头部解析、MAC 地址互换、基于入端口设置出端口等功能。

## 🚀 功能说明

在该示例中，交换机通过以下逻辑实现“反射器”功能：

- 对接收到的数据包解析以太网头部；
- 交换源地址与目的地址；
- 将数据包发送回其原始入端口；
- 重新封装并发送。

最终效果是：主机发送一个数据包后，将收到一个源/目的地址已对调的响应数据包，体现了交换机的正确处理逻辑。

## 📚 技术要点

- 基于 P4_16 标准语法实现；
- 无需查找表，直接在控制流程中完成处理；
- 使用标准 metadata 字段 `standard_metadata.ingress_port` 与 `standard_metadata.egress_spec` 控制转发路径；
- 保持程序结构清晰，便于后续拓展至更加复杂的报文处理任务。

🧪 验证方式

运行测试脚本后，主机会接收到自身发送的数据包副本，验证 P4 程序已按预期完成数据包的反射处理。该行为在调试网络行为、链路连通性测试及协议开发初期具有重要意义。
