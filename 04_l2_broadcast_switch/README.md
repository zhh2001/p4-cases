# 二层广播交换机示例

## 概述

本示例基于 P4 编程语言实现了 二层交换中的广播机制，用于模拟交换机在无法识别目标 MAC 地址时的典型行为。本实验基于先前完成的基本 L2 转发交换机，在此基础上扩展支持广播功能。

## 实现说明

- 为每个端口定义一个对应的多播组，组内不包含该入口端口；
- 引入第二张表，匹配 `ingress_port` 并设置对应多播组；
- 使用 `controller.py` 加载所有表项及多播配置。

## ARP 行为说明

为确保广播 ARP 包正常工作，需 **关闭自动 ARP 表填充机制**。ARP 请求将通过广播机制传播，并在主机之间自动完成表填充。

## 测试方法

1. 在 4 个终端中分别对 `s1-eth1` 至 `s1-eth4` 接口进行抓包：
```bash
sudo tcpdump -enn -i s1-eth1
...
```

2. 使用 Mininet 发送测试包（如 ARP 请求）：
```bash
mininet> h1 ping h2 -c 1
mininet> pingall
```

也可使用 `test.py` 生成广播帧进行测试，需先进入主机命名空间。

预期行为：ARP 请求会在所有端口广播，除了源端口。

## 关键技术点

- 基于 P4 的多播组配置与应用
- 动态匹配 `ingress_port` 实现选择性转发
- 多张转发表协同工作机制
- 使用控制器脚本实现数据面配置注入
- P4 `standard_metadata` 的使用
